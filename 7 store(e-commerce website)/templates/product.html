{% extends "base.html" %}
{% block title %}{{ product.name }}{% endblock %}
{% block content %}
<div class="row">
  <div class="col-lg-6 mb-4">
    <div class="product-gallery shadow-sm">
      {% if product.image_filename %}
        <img src="{{ url_for('uploaded_file', filename=product.image_filename) }}" class="img-fluid main-photo" alt="{{ product.name }}">
      {% else %}
        <img src="{{ url_for('static', filename='images/product-placeholder.png') }}" class="img-fluid main-photo" alt="{{ product.name }}">
      {% endif %}
    </div>
  </div>

  <div class="col-lg-6">
    <h2 class="fw-bold">{{ product.name }}</h2>
    <p class="text-muted small mb-2">Sold by: {% if product.seller %}{{ product.seller.username }}{% else %}7Store{% endif %}</p>
    <div class="mb-3">
      <span class="h3 text-primary fw-semibold">{{ product.price|inr }}</span>
      {% if product.stock <= 0 %}
        <span class="badge bg-secondary ms-2">Out of stock</span>
      {% endif %}
    </div>

    <p class="mb-4 text-muted">{{ product.description }}</p>

    <!-- Add to cart form (POST) with CSRF -->
    <form method="post" action="{{ url_for('shop.add_to_cart', product_id=product.id) }}">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

      <div class="d-flex align-items-center mb-3">
        <label class="me-3">Quantity</label>
        <input type="number" name="qty" value="1" min="1" class="form-control" style="width:100px;">
      </div>

      <div class="d-flex gap-2">
        <button class="btn btn-primary btn-lg">Add to cart</button>
        <a class="btn btn-outline-secondary btn-lg" href="{{ url_for('shop.checkout') }}">Buy now</a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
